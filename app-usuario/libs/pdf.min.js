(function(){
  // Stub mínimo de pdf.js para testes de UI (NÃO processa PDFs reais).
  if (window.pdfjsLib) return;
  window.pdfjsLib = {
    GlobalWorkerOptions: {},
    // getDocument recebe { data: Uint8Array } normalmente; aqui ignoramos o conteúdo
    getDocument: function(opts) {
      // Cria resposta com promise para compatibilidade
      const promise = new Promise((resolve) => {
        // Exemplo: 1 página com algumas linhas de texto no formato que o importador espera
        const doc = {
          numPages: 1,
          getPage: async function(pageNumber) {
            return {
              // Simula a API getTextContent usada pelo código do importador
              getTextContent: async function() {
                // Itens com propriedade `str` — o importador junta item.str por linha
                const items = [
                  { str: 'Nubank' },
                  { str: '2025-09-01;Salario;1500,00;Salario;receita' },
                  { str: '2025-09-03;Supermercado;-120,50;Alimentacao;despesa' },
                  { str: '2025-09-05;Pagamento Loja;-89,90;Lazer;despesa' },
                  { str: '2025-09-10;Pix Cliente;2000,00;Servicos;receita' }
                ];
                return { items };
              }
            };
          }
        };
        resolve(doc);
      });
      return { promise };
    }
  };
  console.info('pdf.js stub loaded: window.pdfjsLib (stub) is available.');
})();
